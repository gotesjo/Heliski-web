YUI.add("flickr-groups-search-fetcher",(function(e,r){"use strict";function s(r){var s=e.merge(r)||{},a={extras:e.APIHelper.request.getRebootGroupExtras()+",use_vespa,membership_info,has_pending_invite,secure_rules",per_page:20,page:1,secure_image_embeds:1},p={filter_inactive_groups:"1",sort:e.SearchHelper.API_SORT_OPTIONS.relevant},t={perPage:"per_page",userId:e.SearchHelper.GROUPS_SEARCH_API.userId,subscriptionTypes:e.SearchHelper.GROUPS_SEARCH_API.subscriptionTypes,filterInactiveGroups:e.SearchHelper.GROUPS_SEARCH_API.filterInactive,safeSearch:e.SearchHelper.GROUPS_SEARCH_API.safeSearch};return Object.keys(s).forEach((function(e){t[e]&&(void 0!==s[e]&&(s[t[e]]=s[e]),delete s[e])})),s=e.merge(a,p,s),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(s),s.text?s:null}e.namespace("ListFetchers")["flickr-groups-search"]={run:function(a,p){var t=s(a),o=[];return t||(a.emptyQuery=!0),a.emptyQuery?o.push(e.Promise.resolve({groups:{group:[]}})):o.push(p.callAPI("flickr.groups.search",t)),o=o.concat([p.getModelRegistry("search-groups-models"),p.getModelRegistry("search-group-models")]),e.Promise.all(o).then(function(e){return this._processResponse(e,a,p)}.bind(this),e.FetcherErrorLogger(r))},_processParams:s,_processResponse:function(r,s,a){var p,t,o,u,i,g=[],l=r[0],c=r[1],n=r[2];if(l.groups&&l.groups.group){for(o=l.groups.group.length,u=0;u<o;u++)i=l.groups.group[u],p=n.parseGroupModel(i.nsid,i.pathAlias,i),g.push(n.addOrUpdate(p));if(t={id:s.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},groups:{perPage:l.groups.perpage,page:l.groups.page||1,pageContent:g,totalItems:l.groups.total,totalPages:l.groups.pages},totalItems:l.groups.total,emptyQuery:!!s.emptyQuery,text:s.text,subscriptionTypes:s.subscriptionTypes,userId:s.userId,filterInactiveGroups:s.filterInactiveGroups,sort:s.sort},l.groups.maxAllowedResults&&(t.groups.totalItems=Math.min(l.groups.maxAllowedResults,l.groups.total)),l.groups.maxAllowedPages&&(t.groups.totalPages=Math.min(l.groups.maxAllowedPages,l.groups.pages)),a.flipper.isFlipped("enable-safe-search-messaging")&&1===l.groups.adjSearchArgs&&(t.adjSearchArgs=l.groups.adjSearchArgs),o)for(;o<t.groups.perPage;o++)t.groups.pageContent.push(!1);return s.id&&s.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(t.apiParams=s.apiParams),c.addOrUpdate(t),g}}}}),"@VERSION@",{requires:["api-helper","flickr-promise","search-helper","search-url","querystring-stringify-simple"]});YUI.add("search-groups-models",(function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-groups-search"].run(t,this.appContext)}},attributes:{id:{},text:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},subscriptionTypes:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},userId:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},groups:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-search"],listItemIdField:"id"}},filterInactiveGroups:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},sort:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},page:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},pages:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},perPage:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},adjSearchArgs:{defaultValue:0},apiParams:{},emptyQuery:{defaultValue:!1}}})}),"@VERSION@",{requires:["attribute-helpers","flickr-model-registry","flickr-groups-search-fetcher","search-helper"]});